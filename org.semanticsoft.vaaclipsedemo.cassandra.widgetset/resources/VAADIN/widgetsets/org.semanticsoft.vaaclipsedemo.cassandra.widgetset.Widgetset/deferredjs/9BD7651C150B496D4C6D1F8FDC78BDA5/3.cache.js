$wnd.org_semanticsoft_vaaclipsedemo_cassandra_widgetset_Widgetset.runAsyncCallback3("function $createFileInputElement(this$static){\n  return $createInputElement(($clinit_DOMImpl() , impl_0 , this$static), 'file');\n}\n\nfunction $createFormElement(this$static){\n  return ($clinit_DOMImpl() , impl_0).createElement_0(this$static, 'form');\n}\n\nfunction $createHiddenInputElement(this$static){\n  return $createInputElement(($clinit_DOMImpl() , impl_0 , this$static), 'hidden');\n}\n\nfunction $setAction(this$static, action){\n  this$static.action = action;\n}\n\nfunction $setMethod(this$static, method){\n  this$static.method = method;\n}\n\nfunction $setTarget(this$static, target){\n  this$static.target = target;\n}\n\nfunction $submit(this$static){\n  this$static.submit();\n}\n\nfunction $getValue(this$static){\n  return this$static.value;\n}\n\nfunction $setName_0(this$static, name_0){\n  this$static.name = name_0;\n}\n\nfunction $$init_344(){\n}\n\nfunction $getFilename(this$static){\n  return $getValue($getInputElement(this$static));\n}\n\nfunction $getInputElement(this$static){\n  return $cast($getElement(this$static));\n}\n\nfunction $onBrowserEvent_0(this$static, event_0){\n  this$static.impl.onBrowserEvent_0(event_0) && $onBrowserEvent(this$static, event_0);\n}\n\nfunction $setName_1(this$static, name_0){\n  $setName_0($getInputElement(this$static), name_0);\n}\n\nfunction FileUpload_0(){\n  Widget_0.call(this);\n  $$init_344();\n  $setElement(this, $createFileInputElement(get_1()));\n  this.setStyleName('gwt-FileUpload');\n  this.impl = new FileUpload$FileUploadImpl_0;\n  this.impl.init_0(this);\n}\n\ndefineSeed(445, 422, makeCastMap([Q$HasAttachHandlers, Q$HasHandlers, Q$EventListener, Q$HasEnabled, Q$HasVisibility, Q$IsWidget, Q$UIObject, Q$Widget]));\n_.onBrowserEvent = function onBrowserEvent_2(event_0){\n  $onBrowserEvent_0(this, event_0);\n}\n;\n_.setEnabled = function setEnabled_2(enabled){\n  $setPropertyBoolean($getElement(this), 'disabled', !enabled);\n}\n;\n_.impl = null;\nfunction $$init_345(){\n}\n\nfunction FileUpload$FileUploadImpl_0(){\n  Object_1.call(this);\n  $$init_345();\n}\n\ndefineSeed(446, 1, {}, FileUpload$FileUploadImpl_0);\n_.init_0 = function init_2(fileUpload){\n}\n;\n_.onBrowserEvent_0 = function onBrowserEvent_3(event_0){\n  return true;\n}\n;\nfunction $$init_363(){\n}\n\nfunction Hidden_0(){\n  Widget_0.call(this);\n  $$init_363();\n  $setElement(this, $createHiddenInputElement(get_1()));\n}\n\ndefineSeed(464, 422, makeCastMap([Q$HasAttachHandlers, Q$HasHandlers, Q$EventListener, Q$HasVisibility, Q$IsWidget, Q$UIObject, Q$Widget]), Hidden_0);\nfunction $load_3(this$static){\n  $setClass(this$static.val$store, 'com.vaadin.ui.Upload', Lcom_vaadin_client_ui_upload_UploadConnector_2_classLit);\n  $setConstructor(this$static.val$store, Lcom_vaadin_client_ui_upload_UploadConnector_2_classLit, new ConnectorBundleLoaderImpl$4$1$1_0(this$static));\n  $setConstructor(this$static.val$store, Lcom_vaadin_client_ui_VUpload_2_classLit, new ConnectorBundleLoaderImpl$4$1$2_0(this$static));\n  $setReturnType(this$static.val$store, Lcom_vaadin_client_ui_upload_UploadConnector_2_classLit, 'getWidget', new Type_0(Lcom_vaadin_client_ui_VUpload_2_classLit));\n  $setReturnType(this$static.val$store, Lcom_vaadin_client_ui_upload_UploadConnector_2_classLit, 'getState', new Type_0(Lcom_vaadin_shared_AbstractComponentState_2_classLit));\n}\n\ndefineSeed(2603, 1, makeCastMap([Q$RunAsyncCallback]));\n_.onSuccess_1 = function onSuccess_4(){\n  $load_3(this);\n  $setLoaded_0(get_14(), $getName_0(this.this$1));\n}\n;\nfunction $$init_2477(){\n}\n\nfunction ConnectorBundleLoaderImpl$4$1$1_0(this$2){\n  this , this$2;\n  Object_1.call(this);\n  $$init_2477();\n}\n\ndefineSeed(2604, 1, makeCastMap([Q$Invoker]), ConnectorBundleLoaderImpl$4$1$1_0);\n_.invoke_0 = function invoke_1869(target, params){\n  return new UploadConnector_0;\n}\n;\nfunction $$init_2478(){\n}\n\nfunction ConnectorBundleLoaderImpl$4$1$2_0(this$2){\n  this , this$2;\n  Object_1.call(this);\n  $$init_2478();\n}\n\ndefineSeed(2605, 1, makeCastMap([Q$Invoker]), ConnectorBundleLoaderImpl$4$1$2_0);\n_.invoke_0 = function invoke_1870(target, params){\n  return new VUpload_0;\n}\n;\nfunction $$init_2755(this$static){\n  this$static.fu = new VUpload$MyFileUpload_0(this$static);\n  this$static.panel = new FlowPanel_0;\n  this$static.onloadstrategy = new UploadIFrameOnloadStrategy_0;\n  this$static.maxfilesize = new Hidden_0;\n}\n\nfunction $cleanTargetFrame(this$static){\n  if (isNotNull(this$static.synthesizedFrame)) {\n    $removeChild($getBody(get_1()), this$static.synthesizedFrame);\n    this$static.onloadstrategy.unHookEvents(this$static.synthesizedFrame);\n    this$static.synthesizedFrame = null;\n  }\n}\n\nfunction $disableUpload(this$static){\n  $setEnabled_3(this$static.submitButton, false);\n  this$static.submitted || $setPropertyBoolean($getElement(this$static.fu), 'disabled', true);\n  this$static.enabled = false;\n}\n\nfunction $enableUpload(this$static){\n  $setEnabled_3(this$static.submitButton, true);\n  $setPropertyBoolean($getElement(this$static.fu), 'disabled', false);\n  this$static.enabled = true;\n  if (this$static.submitted) {\n    $cleanTargetFrame(this$static);\n    this$static.submitted = false;\n  }\n}\n\nfunction $ensureTargetFrame(this$static){\n  var dummy;\n  if (isNull_1(this$static.synthesizedFrame)) {\n    dummy = $createDivElement(get_1());\n    $setInnerHTML(dummy, \"<iframe src=\\\"javascript:''\\\" name='\" + $getFrameName(this$static) + \"' style='position:absolute;width:0;height:0;border:0'>\");\n    this$static.synthesizedFrame = $getFirstChildElement(dummy);\n    $appendChild($getBody(get_1()), this$static.synthesizedFrame);\n    $setTarget(this$static.element, $getFrameName(this$static));\n    this$static.onloadstrategy.hookEvents_0(this$static.synthesizedFrame, this$static);\n  }\n}\n\nfunction $getFrameName(this$static){\n  return this$static.paintableId + '_TGT_FRAME';\n}\n\nfunction $rebuildPanel(this$static){\n  this$static.panel.remove_2(this$static.submitButton);\n  this$static.panel.remove_2(this$static.fu);\n  this$static.fu = new VUpload$MyFileUpload_0(this$static);\n  $setName_1(this$static.fu, this$static.paintableId + '_file');\n  $setPropertyBoolean($getElement(this$static.fu), 'disabled', !this$static.enabled);\n  this$static.panel.add_2(this$static.fu);\n  this$static.panel.add_2(this$static.submitButton);\n  this$static.immediate && this$static.fu.sinkEvents_0(1024);\n}\n\nfunction $setImmediate_1(this$static, booleanAttribute){\n  if (this$static.immediate != booleanAttribute) {\n    this$static.immediate = booleanAttribute;\n    if (this$static.immediate) {\n      this$static.fu.sinkEvents_0(1024);\n      this$static.fu.sinkEvents_0(2048);\n    }\n  }\n  setStyleName_0($getElement(this$static), 'v-upload-immediate', this$static.immediate);\n}\n\nfunction $submit_0(this$static){\n  if ($length_1($getFilename(this$static.fu)) == 0 || this$static.submitted || !this$static.enabled) {\n    log_5('Submit cancelled (disabled, no file or already submitted)');\n    return;\n  }\n  $sendPendingVariableChanges(this$static.client);\n  $submit(this$static.element);\n  this$static.submitted = true;\n  log_5('Submitted form');\n  $disableUpload(this$static);\n  this$static.t = new VUpload$3_0(this$static);\n  $schedule(this$static.t, 800);\n}\n\nfunction VUpload_0(){\n  $clinit_UIObject();\n  SimplePanel_1.call(this, $createFormElement(get_1()));\n  $$init_2755(this);\n  this.element = $cast($getElement(this));\n  setEncoding($getElement(this), 'multipart/form-data');\n  $setMethod(this.element, 'post');\n  this.setWidget(this.panel);\n  this.panel.add_2(this.maxfilesize);\n  this.panel.add_2(this.fu);\n  this.submitButton = new VButton_0;\n  $addClickHandler(this.submitButton, new VUpload$1_0(this));\n  this.panel.add_2(this.submitButton);\n  this.setStyleName('v-upload');\n}\n\nfunction fireNativeBlur(element){\n  element.blur();\n}\n\nfunction fireNativeClick(element){\n  $clinit_UIObject();\n  element.click();\n}\n\nfunction setEncoding(form, encoding){\n  form.enctype = encoding;\n  form.encoding = encoding;\n}\n\ndefineSeed(2886, 442, makeCastMap([Q$HasAttachHandlers, Q$HasHandlers, Q$EventListener, Q$AcceptsOneWidget, Q$HasOneWidget, Q$HasVisibility, Q$HasWidgets, Q$HasWidgets$ForIsWidget, Q$IsWidget, Q$Panel, Q$SimplePanel, Q$UIObject, Q$Widget, Q$VUpload, Q$Iterable]), VUpload_0);\n_.onAttach = function onAttach_7(){\n  $onAttach(this);\n  isNotNull(this.client) && $ensureTargetFrame(this);\n}\n;\n_.onDetach = function onDetach_19(){\n  $onDetach(this);\n  this.submitted || $cleanTargetFrame(this);\n}\n;\n_.onSubmitComplete = function onSubmitComplete(){\n  $clinit_UIObject();\n  get_0().scheduleDeferred(new VUpload$2_0(this));\n}\n;\n_.client = null;\n_.element = null;\n_.enabled = true;\n_.immediate = false;\n_.nextUploadId = 0;\n_.paintableId = null;\n_.submitButton = null;\n_.submitted = false;\n_.synthesizedFrame = null;\n_.t = null;\nfunction $$init_2756(){\n}\n\nfunction VUpload$1_0(this$0){\n  this.this$0 = this$0;\n  Object_1.call(this);\n  $$init_2756();\n}\n\ndefineSeed(2887, 1, makeCastMap([Q$ClickHandler, Q$EventHandler]), VUpload$1_0);\n_.onClick = function onClick_32(event_0){\n  this.this$0.immediate?fireNativeClick($getElement(this.this$0.fu)):$submit_0(this.this$0);\n}\n;\n_.this$0 = null;\nfunction $$init_2757(){\n}\n\nfunction VUpload$2_0(this$0){\n  this.this$0 = this$0;\n  Object_1.call(this);\n  $$init_2757();\n}\n\ndefineSeed(2888, 1, makeCastMap([Q$Scheduler$ScheduledCommand, Q$Command]), VUpload$2_0);\n_.execute_1 = function execute_65(){\n  if (this.this$0.submitted) {\n    if (isNotNull(this.this$0.client)) {\n      isNotNull(this.this$0.t) && $cancel_0(this.this$0.t);\n      log_5('VUpload:Submit complete');\n      $sendPendingVariableChanges(this.this$0.client);\n    }\n    $rebuildPanel(this.this$0);\n    this.this$0.submitted = false;\n    $enableUpload(this.this$0);\n    this.this$0.isAttached() || $cleanTargetFrame(this.this$0);\n  }\n}\n;\n_.this$0 = null;\nfunction $$init_2758(){\n}\n\nfunction VUpload$3_0(this$0){\n  $clinit_Timer();\n  this.this$0 = this$0;\n  Timer_0.call(this);\n  $$init_2758();\n}\n\ndefineSeed(2889, 10, makeCastMap([Q$Timer]), VUpload$3_0);\n_.run = function run_39(){\n  log_5('Visiting server to see if upload started event changed UI.');\n  $updateVariable(this.this$0.client, this.this$0.paintableId, 'pollForStart', this.this$0.nextUploadId, true);\n}\n;\n_.this$0 = null;\nfunction $$init_2759(){\n}\n\nfunction VUpload$MyFileUpload_0(this$0){\n  this.this$0 = this$0;\n  FileUpload_0.call(this);\n  $$init_2759();\n}\n\ndefineSeed(2890, 445, makeCastMap([Q$HasAttachHandlers, Q$HasHandlers, Q$EventListener, Q$HasEnabled, Q$HasVisibility, Q$IsWidget, Q$UIObject, Q$Widget]), VUpload$MyFileUpload_0);\n_.onBrowserEvent = function onBrowserEvent_42(event_0){\n  $onBrowserEvent_0(this, event_0);\n  if ($getTypeInt(event_0) == 1024) {\n    this.this$0.immediate && jsNotEquals($getFilename(this.this$0.fu), null) && !$equals_6('', $getFilename(this.this$0.fu)) && $submit_0(this.this$0);\n  }\n   else if ($isIE(get_10()) && $getTypeInt(event_0) == 2048) {\n    fireNativeClick($getElement(this.this$0.fu));\n    fireNativeBlur($getElement(this.this$0.fu));\n  }\n}\n;\n_.this$0 = null;\nfunction $$init_2909(){\n}\n\nfunction $getWidget_61(this$static){\n  return dynamicCast($getWidget_2(this$static), Q$VUpload);\n}\n\nfunction UploadConnector_0(){\n  AbstractComponentConnector_0.call(this);\n  $$init_2909();\n}\n\ndefineSeed(3063, 2645, makeCastMap([Q$EventHandler, Q$ComponentConnector, Q$Paintable, Q$ServerConnector, Q$StateChangeEvent$StateChangeHandler, Q$Connector, Q$Serializable]), UploadConnector_0);\n_.getWidget_0 = function getWidget_80(){\n  return $getWidget_61(this);\n}\n;\n_.updateFromUIDL = function updateFromUIDL_24(uidl, client){\n  var action;\n  if (!isRealUpdate(uidl)) {\n    return;\n  }\n  if ($hasAttribute_0(uidl, 'notStarted')) {\n    $schedule($getWidget_61(this).t, 400);\n    return;\n  }\n  if ($hasAttribute_0(uidl, 'forceSubmit')) {\n    $submit_0($getWidget_61(this));\n    return;\n  }\n  $setImmediate_1($getWidget_61(this), this.getState().immediate);\n  $getWidget_61(this).client = client;\n  $getWidget_61(this).paintableId = $getId_0(uidl);\n  $getWidget_61(this).nextUploadId = $getIntAttribute(uidl, 'nextid');\n  action = $translateVaadinUri(client, $getStringVariable(uidl, 'action'));\n  $setAction($getWidget_61(this).element, action);\n  if ($hasAttribute_0(uidl, 'buttoncaption')) {\n    $setText_7($getWidget_61(this).submitButton, $getStringAttribute(uidl, 'buttoncaption'));\n    $getWidget_61(this).submitButton.setVisible(true);\n  }\n   else {\n    $getWidget_61(this).submitButton.setVisible(false);\n  }\n  $setName_1($getWidget_61(this).fu, $getWidget_61(this).paintableId + '_file');\n  if (!$isEnabled_2(this) || this.isReadOnly()) {\n    $disableUpload($getWidget_61(this));\n  }\n   else if (!$getBooleanAttribute(uidl, 'state')) {\n    $enableUpload($getWidget_61(this));\n    $ensureTargetFrame($getWidget_61(this));\n  }\n}\n;\nfunction $$init_2910(){\n}\n\nfunction UploadIFrameOnloadStrategy_0(){\n  Object_1.call(this);\n  $$init_2910();\n}\n\ndefineSeed(3064, 1, {}, UploadIFrameOnloadStrategy_0);\n_.hookEvents_0 = function hookEvents_2(iframe, upload){\n  iframe.onload = $entry(function(){\n    upload.onSubmitComplete();\n  }\n  );\n}\n;\n_.unHookEvents = function unHookEvents(iframe){\n  iframe.onload = null;\n}\n;\nvar Lcom_vaadin_client_ui_upload_UploadConnector_2_classLit = createForClass('com.vaadin.client.ui.upload.', 'UploadConnector', 3063, Lcom_vaadin_client_ui_AbstractComponentConnector_2_classLit), Lcom_vaadin_client_ui_VUpload_2_classLit = createForClass('com.vaadin.client.ui.', 'VUpload', 2886, Lcom_google_gwt_user_client_ui_SimplePanel_2_classLit), Lcom_vaadin_client_metadata_ConnectorBundleLoaderImpl$4$1$1_2_classLit = createForClass('com.vaadin.client.metadata.', 'ConnectorBundleLoaderImpl$4$1$1', 2604, Ljava_lang_Object_2_classLit), Lcom_vaadin_client_metadata_ConnectorBundleLoaderImpl$4$1$2_2_classLit = createForClass('com.vaadin.client.metadata.', 'ConnectorBundleLoaderImpl$4$1$2', 2605, Ljava_lang_Object_2_classLit), Lcom_google_gwt_user_client_ui_FileUpload_2_classLit = createForClass('com.google.gwt.user.client.ui.', 'FileUpload', 445, Lcom_google_gwt_user_client_ui_Widget_2_classLit), Lcom_vaadin_client_ui_VUpload$MyFileUpload_2_classLit = createForClass('com.vaadin.client.ui.', 'VUpload$MyFileUpload', 2890, Lcom_google_gwt_user_client_ui_FileUpload_2_classLit), Lcom_vaadin_client_ui_VUpload$1_2_classLit = createForClass('com.vaadin.client.ui.', 'VUpload$1', 2887, Ljava_lang_Object_2_classLit), Lcom_vaadin_client_ui_VUpload$2_2_classLit = createForClass('com.vaadin.client.ui.', 'VUpload$2', 2888, Ljava_lang_Object_2_classLit), Lcom_vaadin_client_ui_VUpload$3_2_classLit = createForClass('com.vaadin.client.ui.', 'VUpload$3', 2889, Lcom_google_gwt_user_client_Timer_2_classLit), Lcom_google_gwt_user_client_ui_FileUpload$FileUploadImpl_2_classLit = createForClass('com.google.gwt.user.client.ui.', 'FileUpload$FileUploadImpl', 446, Ljava_lang_Object_2_classLit), Lcom_google_gwt_user_client_ui_Hidden_2_classLit = createForClass('com.google.gwt.user.client.ui.', 'Hidden', 464, Lcom_google_gwt_user_client_ui_Widget_2_classLit), Lcom_vaadin_client_ui_upload_UploadIFrameOnloadStrategy_2_classLit = createForClass('com.vaadin.client.ui.upload.', 'UploadIFrameOnloadStrategy', 3064, Ljava_lang_Object_2_classLit);\n$entry(onLoad)(3);\n\n//@ sourceURL=3.js\n")
